# 3.2.1 虚拟内存的基本概念

1、传统存储管理方式的特征、缺点

之前讲的

一次性：作业必须全部装入内存后才能开始运行，并发性下降

驻留性：一旦作业被装入内存，就会一直驻留在内存

2、局部性原理

- 时间局部性
- 空间局部性
- 高速缓存技术

3、虚拟内存的定义和特征

虚拟内存最大容量是计算机地址结构确定的

虚拟内存的实际容量=min(内存和外存容量之和，CPU寻址范围)

eg：某计算机地址结构为32位，按字节编址，内存大小为512MB，外存大小为2DB.

则虚拟内存的最大容量为 2^32B=4GB

虚拟内存的实际容量=min(2^32B,512MB+2GB)=2GB+512MB

*多次性*：无需在作业运行时一次性全部装入内存，而是允许被分成多次调用内存

*对换性*：在作业运行时无需一直常驻内存，而是允许在作业运行过程中，将作业换入换出

*虚拟性*：从逻辑上扩充了内存的容量，使用户看到的内存容量，远大于实际的容量

4、如何实现虚拟内存技术

在程序执行过程中，当所访问的信息不再内存时，由操作系统负责将所需信息从外存调入内存，然后继续执行程序。

若内存空间不够，由操作系统负责将内存中暂时用不到的信息换出到外存。

# 3.2.2 请求分页管理方式

1、页表机制

请求分页存储的页表：

内存块号 状态位 访问字段 修改位 外存地址

2、缺页中断机构

内中断，可被修复

3、地址变换机构

# 3.2.3 页面置换算法

1、最佳置换算法（OPT）
每次选择淘汰的页面是以后永不使用或者在最长时间内不再被访问的页面，这样可以保证最低的缺页率。
实际上不知道后面的序列

2、先进先出置换算法（FIFO）
每次选择淘汰的页面是最早进入内存的页面
Belady异常，当分配的内存块增大时，缺页次数反而增加

3、最近最久未使用置换算法（LRU）
每次淘汰最近最久未使用的页面

4、时钟置换算法（最近未用算法，CLOCK）
简单的：最多经历两轮扫描，初始为1，扫一下为0，再扫一下被踢

5、改进型的时钟置换算法
优先淘汰没有被修改过的，因为没有修改过的不用进行IO操作00->01（改）->00->01

# 3.2.4 页面分配策略

1、驻留集
指请求分页存储管理中给进程分配的物理块的集合

2、页面分配、置换策略
- 固定分配局部替换：驻留集大小不可改变
- 可变分配全局替换：可以将操作系统保留的空闲物理块分配给缺页进程
- 可变分配局部替换：只能选进程自己的物理块置换

3、调入页面的时机
预调页策略：一次调用若干个相邻页面，运行前调入
请求调页策略：运行时缺页再调入

4、从何处调页
对换区：快，采用连续分配方式
文件区：慢，采用离散分配方式

5、抖动（颠簸）现象
刚刚换出的又要换入，刚刚换入的又要换出，物理块不够

6、工作集
指在某段时间间隔里，进程实际访问页面的集合